<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<title>ØªÙØ±ÙŠØ§Ù‚ÙŠ - ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</title>

<style>
body {
    font-family: 'Tajawal', sans-serif;
    background: linear-gradient(135deg, #0d9488, #065f46);
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
}

.container {
    background: white;
    padding: 40px;
    border-radius: 15px;
    width: 380px;
    box-shadow: 0 10px 25px rgba(0,0,0,0.2);
    text-align: center;
    position: relative;
}

h2 {
    color: #065f46;
}

input {
    width: 100%;
    padding: 10px;
    margin: 8px 0;
    border-radius: 8px;
    border: 1px solid #ccc;
}

button {
    width: 100%;
    padding: 12px;
    background: #0d9488;
    color: white;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    font-weight: bold;
    margin-top: 10px;
}

button:hover {
    background: #065f46;
}

.toggle {
    margin-top: 15px;
    cursor: pointer;
    color: #0d9488;
    font-weight: bold;
}

.hidden {
    display: none;
}

.message {
    margin-top: 15px;
    font-weight: bold;
}
</style>
</head>

<body>

<div class="container">

    <h2 id="formTitle">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</h2>

    <!-- Ø§Ù„Ø§Ø³Ù… ÙŠØ¸Ù‡Ø± ÙÙ‚Ø· ÙÙŠ Ø§Ù„ØªØ³Ø¬ÙŠÙ„ -->
    <input type="text" id="full_name" placeholder="Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„" class="hidden">
    <input type="text" id="phone" placeholder="Ø±Ù‚Ù… Ø§Ù„Ø¬ÙˆØ§Ù„" class="hidden">

    <input type="email" id="email" placeholder="Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ">
    <input type="password" id="password" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">

    <button onclick="submitForm()" id="mainButton">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</button>

    <div class="toggle" onclick="toggleMode()" id="toggleText">
        Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ Ø­Ø³Ø§Ø¨ØŸ Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨
    </div>

    <div class="message" id="message"></div>

</div>

<script>

let isLogin = true;

function toggleMode() {

    const fullName = document.getElementById("full_name");
    const phone = document.getElementById("phone");
    const title = document.getElementById("formTitle");
    const button = document.getElementById("mainButton");
    const toggleText = document.getElementById("toggleText");
    const message = document.getElementById("message");

    message.innerText = "";

    if(isLogin) {
        fullName.classList.remove("hidden");
        phone.classList.remove("hidden");
        title.innerText = "Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨";
        button.innerText = "Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨";
        toggleText.innerText = "Ù„Ø¯ÙŠÙƒ Ø­Ø³Ø§Ø¨ØŸ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„";
        isLogin = false;
    } else {
        fullName.classList.add("hidden");
        phone.classList.add("hidden");
        title.innerText = "ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„";
        button.innerText = "ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„";
        toggleText.innerText = "Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ Ø­Ø³Ø§Ø¨ØŸ Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨";
        isLogin = true;
    }
}

function submitForm() {

    const email = document.getElementById("email").value;
    const password = document.getElementById("password").value;
    const full_name = document.getElementById("full_name").value;
    const phone = document.getElementById("phone").value;
    const messageDiv = document.getElementById("message");

    if(isLogin) {

        fetch("http://localhost/triyaqi-api/index.php/login", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ email, password })
        })
        .then(res => res.json())
        .then(data => {

            if(data.message === "Login Successful") {
                messageDiv.style.color = "green";
                messageDiv.innerText = "ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ù†Ø¬Ø§Ø­ âœ…";

                localStorage.setItem("user_id", data.user_id);

                setTimeout(() => {
                    window.location.href = "index.html";
                }, 1500);

            } else {
                messageDiv.style.color = "red";
                messageDiv.innerText = data.message;
            }
        });

    } else {

        fetch("http://localhost/triyaqi-api/index.php/register", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ full_name, email, password, phone })
        })
        .then(res => res.json())
        .then(data => {

            if(data.message === "User Registered Successfully") {
                messageDiv.style.color = "green";
                messageDiv.innerText = "ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨ Ø¨Ù†Ø¬Ø§Ø­ ğŸ‰";
                toggleMode();
            } else {
                messageDiv.style.color = "red";
                messageDiv.innerText = data.message;
            }
        });

    }
}
</script>

</body>
</html>